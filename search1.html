
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GASæ­·å±†è¤‡ç¿’è€ƒè©¦é¡ŒæŸ¥è©¢</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
        }
        h1 { color: #333; margin-bottom: 10px; }
        .search { margin-bottom: 20px; }
        #myInput {
            width: 50%; font-size: 18px; padding: 10px;
            border-radius: 10px; border: 2px solid #007BFF;
            background-color: white; transition: all 0.3s;
        }
        #myInput:focus {
            border-color: #0056b3; box-shadow: 0 0 8px rgba(0, 123, 255, 0.5);
            outline: none;
        }
        table {
            margin: 0 auto; border-collapse: collapse; width: 90%;
            background: white; border-radius: 8px; overflow: hidden;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);
        }
        #myTable th, #myTable td {
            padding: 12px; border-bottom: 1px solid #ddd;font-size: 20px;
        }
        #myTable th {
            background-color: #007BFF; color: white; font-size: 18px;
        }
        #myTable tr:hover { background-color: #f1f1f1; }
        button {
            padding: 8px 12px; font-size: 14px;
            border: none; border-radius: 5px; cursor: pointer;
            transition: all 0.3s;
        }
        .edit-btn { background-color: #ffc107; color: black; }
        .edit-btn:hover { background-color: #e0a800; }
        .delete-btn { background-color: #dc3545; color: white; }
        .delete-btn:hover { background-color: #c82333; }
        .add-btn { background-color: #28a745; color: white; }
        .add-btn:hover { background-color: #218838; }
        #dataForm {
            display: none; position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); background: white;
            padding: 20px; box-shadow: 0px 0px 15px rgba(0, 0, 0, 0.3);
            border-radius: 10px; text-align: left;
        }
        #dataForm input {
            width: 100%; padding: 8px; margin-bottom: 10px;
            border: 1px solid #ddd; border-radius: 5px;
        }
        .close-btn { background-color: #6c757d; color: white; }
        .close-btn:hover { background-color: #5a6268; }
    </style>
</head>
<body>

    <h1>æ­·å±†è¤‡ç¿’è€ƒè©¦é¡Œåˆ—è¡¨</h1>

    <!-- æŸ¥è©¢æ¬„ -->
    <div class="search">
        <input type="text" id="myInput" placeholder="ğŸ” è«‹è¼¸å…¥è¦æœå°‹çš„é—œéµå­—">
    </div>

    <!-- æ“ä½œæŒ‰éˆ• -->
    <button class="add-btn" onclick="showForm()">â• æ–°å¢è³‡æ–™</button>

    <!-- è¡¨å–®å€ -->
    <div id="dataForm">
        <h2>ğŸ“Œ ç·¨è¼¯è³‡æ–™</h2>
        <input type="hidden" id="rowIndex">
        å¹´åº¦: <input type="text" id="year"><br>
        æ¬¡åˆ¥: <input type="text" id="term"><br>
        å‡ºç‰ˆç¤¾: <input type="text" id="publisher"><br>
        é¡Œè™Ÿ: <input type="text" id="question"><br>
        å†Šåˆ¥å–®å…ƒ: <input type="text" id="unit"><br>
        æ¸¬é©—å…§å®¹: <input type="text" id="content"><br>
	ç­”æ¡ˆ: <input type="text" id="answer"><br>
        <button class="add-btn" onclick="saveData()">ğŸ’¾ å„²å­˜</button>
        <button class="close-btn" onclick="hideForm()">âŒ é—œé–‰</button>
    </div>

    <table id="myTable">
        <thead>
            <tr>
                <th>å¹´åº¦</th><th>æ¬¡åˆ¥</th><th>å‡ºç‰ˆç¤¾</th><th>é¡Œè™Ÿ</th><th>å†Šåˆ¥åŠå–®å…ƒ</th><th>æ¸¬é©—å…§å®¹</th><th>ç­”æ¡ˆ</th><th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody id="myBody"></tbody>
    </table>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbxQizuyjNz2azSzCw5ut4FBAJdjwJK2avXjonGZc50LfvaPM9q8l7KRTHLVGugZUY6r/exec"; //âš ï¸ è«‹å¡«å…¥ä½ çš„ API ç¶²å€

        async function fetchSheetData() {
            const response = await fetch(API_URL);
            return await response.json();
        }

        async function loadTable() {
            const data = await fetchSheetData();
            const tableBody = $("#myBody");
            tableBody.empty();

            for (let i = 1; i < data.length; i++) {
                const row = data[i];
                let newRow = `<tr>
                    <td>${row[0]}</td><td>${row[1]}</td><td>${row[2]}</td>
                    <td>${row[3]}</td><td>${row[4]}</td><td>${row[5]}</td><td>${row[6]}</td>
                    <td>
                        <button class="edit-btn" onclick="editRow(${i}, '${row.join("','")}')">âœï¸ ä¿®æ”¹</button>
                        <button class="delete-btn" onclick="deleteRow(${i})">ğŸ—‘ï¸ åˆªé™¤</button>
                    </td>
                </tr>`;
                tableBody.append(newRow);
            }
        }

        function showForm() { $("#dataForm").show(); }
        function hideForm() { $("#dataForm").hide(); }

        function editRow(index, å¹´åº¦, æ¬¡åˆ¥, å‡ºç‰ˆç¤¾, é¡Œè™Ÿ, å†Šåˆ¥å–®å…ƒ, æ¸¬é©—å…§å®¹,ç­”æ¡ˆ) {
            $("#rowIndex").val(index);
            $("#year").val(å¹´åº¦);
            $("#term").val(æ¬¡åˆ¥);
            $("#publisher").val(å‡ºç‰ˆç¤¾);
            $("#question").val(é¡Œè™Ÿ);
            $("#unit").val(å†Šåˆ¥å–®å…ƒ);
            $("#content").val(æ¸¬é©—å…§å®¹);
	    $("#answer").val(ç­”æ¡ˆ);
            showForm();
        }

        async function deleteRow(index) {
            if (!confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†è³‡æ–™å—ï¼Ÿ")) return;
            const params = new URLSearchParams({ action: "delete", row: index });
            await fetch(API_URL, { method: "POST", body: params });
            await loadTable();
        }

        async function saveData() {
            const params = new URLSearchParams({
                action: $("#rowIndex").val() ? "update" : "add",
                row: $("#rowIndex").val(),
                å¹´åº¦: $("#year").val(), æ¬¡åˆ¥: $("#term").val(), å‡ºç‰ˆç¤¾: $("#publisher").val(),
                é¡Œè™Ÿ: $("#question").val(), å†Šåˆ¥å–®å…ƒ: $("#unit").val(), æ¸¬é©—å…§å®¹: $("#content").val(),$("#answer").val(ç­”æ¡ˆ)
            });

            await fetch(API_URL, { method: "POST", body: params });
            hideForm();
            await loadTable();
        }

        $(document).ready(function () {
            loadTable();

            // ğŸ”¥ ä¿®æ­£æŸ¥è©¢åŠŸèƒ½å¤±æ•ˆå•é¡Œ
            $("#myInput").on("keyup", function () {
                let value = $(this).val().toLowerCase();
                $("#myBody tr").filter(function () {
                    $(this).toggle($(this).text().toLowerCase().includes(value));
                });
            });
        });
    </script>

</body>
</html>
